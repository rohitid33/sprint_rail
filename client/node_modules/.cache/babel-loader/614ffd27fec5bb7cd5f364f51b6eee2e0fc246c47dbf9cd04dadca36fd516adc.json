{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\msi\\\\Desktop\\\\sprint\\\\sprint_code\\\\client\\\\src\\\\components\\\\TopicDetail.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { Box, Typography, Button, Dialog, DialogTitle, DialogContent, DialogActions, TextField, CircularProgress, Stack, Paper, IconButton } from '@mui/material';\nimport DeleteIcon from '@mui/icons-material/Delete';\nimport { DragDropContext, Droppable, Draggable } from '@hello-pangea/dnd';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { fetchCardsForTopic, fetchTopicPerformance, addCardToTopic, reviewCard, deleteCard, reorderCards, updateCardKeywords, updateCardContent } from '../api';\nimport Blank from './Blank';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function TopicDetail({\n  subject,\n  module,\n  chapter,\n  section,\n  topic,\n  onBack\n}) {\n  _s();\n  // Tabs state (persisted in localStorage)\n  const [tab, setTab] = useState(() => localStorage.getItem('topicDetailTab') || 'cards');\n  // Persist tab selection\n  React.useEffect(() => {\n    localStorage.setItem('topicDetailTab', tab);\n  }, [tab]);\n  // Track card click counts for this session\n\n  // ...\n  // (keep all other hooks and logic)\n\n  const queryClient = useQueryClient();\n  // Performance stats\n  const {\n    data: performance,\n    isLoading: perfLoading\n  } = useQuery({\n    queryKey: ['topicPerformance', subject, module, chapter, section, topic],\n    queryFn: () => fetchTopicPerformance(subject, module, chapter, section, topic),\n    enabled: !!topic\n  });\n  // Cards\n  const {\n    data: cardsData = [],\n    isLoading: cardsLoading\n  } = useQuery({\n    queryKey: ['cards', subject, module, chapter, section, topic],\n    queryFn: () => fetchCardsForTopic(subject, module, chapter, section, topic),\n    enabled: !!topic\n  });\n  const [cards, setCards] = useState([]);\n  React.useEffect(() => {\n    setCards(cardsData);\n  }, [cardsData]);\n  // Add card modal\n  const [addOpen, setAddOpen] = useState(false);\n  const [newCard, setNewCard] = useState('');\n  const addCardMutation = useMutation({\n    mutationFn: content => addCardToTopic(subject, module, chapter, section, topic, content),\n    onSuccess: () => {\n      queryClient.invalidateQueries(['cards', subject, module, chapter, section, topic]);\n      setNewCard('');\n      setAddOpen(false);\n    }\n  });\n\n  // Edit card modal\n  const [editCardModal, setEditCardModal] = useState({\n    open: false,\n    card: null,\n    value: ''\n  });\n  const editCardMutation = useMutation({\n    mutationFn: ({\n      cardId,\n      content\n    }) => updateCardContent(cardId, content),\n    onSuccess: () => {\n      queryClient.invalidateQueries(['cards', subject, module, chapter, section, topic]);\n      setEditCardModal({\n        open: false,\n        card: null,\n        value: ''\n      });\n    }\n  });\n  const handleOpenEditCard = card => {\n    setEditCardModal({\n      open: true,\n      card,\n      value: card.content\n    });\n  };\n  const handleCloseEditCard = () => {\n    setEditCardModal({\n      open: false,\n      card: null,\n      value: ''\n    });\n  };\n  const handleSaveEditCard = () => {\n    if (editCardModal.card && editCardModal.value.trim()) {\n      editCardMutation.mutate({\n        cardId: editCardModal.card._id,\n        content: editCardModal.value\n      });\n    }\n  };\n  // Review modal\n  const [reviewOpen, setReviewOpen] = useState(false);\n  const [reviewIdx, setReviewIdx] = useState(0);\n  const [sessionScore, setSessionScore] = useState(0);\n  const [sessionDone, setSessionDone] = useState(false);\n  // Track reviewMode for review modal\n\n  // --- Forgotten Blanks State ---\n  const [forgottenBlanks, setForgottenBlanks] = useState([]);\n  // Fetch forgotten blanks for the current card in review\n  React.useEffect(() => {\n    async function fetchBlanks() {\n      var _cards$reviewIdx;\n      if (reviewOpen && (_cards$reviewIdx = cards[reviewIdx]) !== null && _cards$reviewIdx !== void 0 && _cards$reviewIdx._id) {\n        try {\n          const res = await import('../api').then(api => api.fetchForgottenBlanks(cards[reviewIdx]._id));\n          setForgottenBlanks(res.forgottenBlanks || []);\n        } catch (err) {\n          setForgottenBlanks([]);\n        }\n      }\n    }\n    fetchBlanks();\n  }, [reviewOpen, reviewIdx, cards]);\n  // Handler to toggle forgotten state\n  const handleToggleForgotten = async (blankIdx, forgotten) => {\n    let updated = forgotten ? [...new Set([...forgottenBlanks, blankIdx])] // add\n    : forgottenBlanks.filter(idx => idx !== blankIdx); // remove\n    setForgottenBlanks(updated);\n    // Persist to backend\n    try {\n      await import('../api').then(api => api.updateForgottenBlanks(cards[reviewIdx]._id, updated));\n    } catch {}\n  };\n  const reviewMutation = useMutation({\n    mutationFn: ({\n      cardId,\n      remembered\n    }) => reviewCard(cardId, remembered),\n    onSuccess: () => {\n      queryClient.invalidateQueries(['cards', subject, module, chapter, section, topic]);\n      queryClient.invalidateQueries(['topicPerformance', subject, module, chapter, section, topic]);\n    }\n  });\n\n  // Start review\n  const handleCloseReview = () => {\n    setReviewOpen(false);\n    // After review session, update forgottenBlanks for the reviewed card\n    setCards(prevCards => {\n      var _cards$reviewIdx2;\n      if (!((_cards$reviewIdx2 = cards[reviewIdx]) !== null && _cards$reviewIdx2 !== void 0 && _cards$reviewIdx2._id)) return prevCards;\n      return prevCards.map(card => card._id === cards[reviewIdx]._id ? {\n        ...card,\n        forgottenBlanks: forgottenBlanks\n      } : card);\n    });\n  };\n  const handleStart = () => {\n    setReviewIdx(0);\n    setSessionScore(0);\n    setSessionDone(false);\n    // Reset forgottenBlanks for all cards\n    setCards(prevCards => prevCards.map(card => ({\n      ...card,\n      forgottenBlanks: []\n    })));\n    setReviewOpen(true);\n  };\n\n  // Review action\n  const handleReview = remembered => {\n    const card = cards[reviewIdx];\n    reviewMutation.mutate({\n      cardId: card._id,\n      remembered\n    });\n    if (remembered) setSessionScore(s => s + 1);\n    if (reviewIdx + 1 < cards.length) {\n      setReviewIdx(i => i + 1);\n    } else {\n      setSessionDone(true);\n    }\n  };\n  // --- Drag and Drop (Reorder) ---\n\n  const handleDragEnd = async result => {\n    if (!result.destination) return;\n    const reordered = Array.from(cards);\n    const [removed] = reordered.splice(result.source.index, 1);\n    reordered.splice(result.destination.index, 0, removed);\n    setCards(reordered); // Update local state for instant feedback\n    try {\n      await reorderCards(subject, module, chapter, section, topic, reordered.map(c => c._id));\n      queryClient.invalidateQueries(['cards', subject, module, chapter, section, topic]);\n    } catch (err) {}\n  };\n\n  // --- Delete Card ---\n  const handleDeleteCard = card => {\n    if (window.confirm('Delete this card?')) {\n      deleteCard(card._id).then(() => {\n        queryClient.invalidateQueries(['cards', subject, module, chapter, section, topic]);\n      });\n    }\n  };\n\n  // --- Keyword Editing State ---\n  const [editKeywordsCard, setEditKeywordsCard] = useState(null);\n  const [editKeywordsLoading, setEditKeywordsLoading] = useState(false);\n  const handleOpenEditKeywords = card => {\n    setEditKeywordsCard({\n      ...card,\n      keywordIndices: Array.isArray(card.keywords) ? card.keywords : []\n    });\n  };\n  const handleToggleKeyword = idx => {\n    let indices = Array.isArray(editKeywordsCard.keywordIndices) ? [...editKeywordsCard.keywordIndices] : [];\n    if (indices.includes(idx)) {\n      indices = indices.filter(i => i !== idx);\n    } else {\n      indices.push(idx);\n    }\n    setEditKeywordsCard({\n      ...editKeywordsCard,\n      keywordIndices: indices\n    });\n  };\n  const handleCloseEditKeywords = () => {\n    setEditKeywordsCard(null);\n    setEditKeywordsLoading(false);\n  };\n  const handleSaveEditKeywords = async () => {\n    setEditKeywordsLoading(true);\n    try {\n      await updateCardKeywords(editKeywordsCard._id, editKeywordsCard.keywordIndices);\n      queryClient.invalidateQueries(['cards', subject, module, chapter, section, topic]);\n      handleCloseEditKeywords();\n    } catch (err) {\n      setEditKeywordsLoading(false);\n    }\n  };\n  function highlightKeywords(text, keywordIndices, asBlanks = false, forgottenBlanks = [], onToggleForgotten = () => {}) {\n    if (!Array.isArray(keywordIndices) || keywordIndices.length === 0) return /*#__PURE__*/_jsxDEV(\"span\", {\n      style: {\n        whiteSpace: 'pre-line'\n      },\n      children: text\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 14\n    }, this);\n    const words = text.split(/(\\s+)/); // keep spaces as tokens\n    let wordCounter = -1;\n    const highlighted = words.map((word, idx) => {\n      if (/^\\s+$/.test(word)) return word;\n      wordCounter++;\n      if (keywordIndices.includes(wordCounter)) {\n        if (asBlanks) {\n          return /*#__PURE__*/_jsxDEV(Blank, {\n            idx: wordCounter,\n            word: word,\n            forgotten: forgottenBlanks.includes(wordCounter),\n            onToggleForgotten: onToggleForgotten\n          }, idx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 13\n          }, this);\n        } else {\n          // In cards view, highlight forgotten keywords in red\n          if (forgottenBlanks && forgottenBlanks.includes(wordCounter)) {\n            return /*#__PURE__*/_jsxDEV(\"mark\", {\n              style: {\n                background: '#ffcccc',\n                color: '#b71c1c'\n              },\n              children: word\n            }, idx, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 18\n            }, this);\n          }\n          return /*#__PURE__*/_jsxDEV(\"mark\", {\n            children: word\n          }, idx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 16\n          }, this);\n        }\n      }\n      return word;\n    });\n    return /*#__PURE__*/_jsxDEV(\"span\", {\n      style: {\n        whiteSpace: 'pre-line'\n      },\n      children: highlighted\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Paper, {\n    sx: {\n      p: 2,\n      mt: 2\n    },\n    children: [/*#__PURE__*/_jsxDEV(Stack, {\n      direction: \"row\",\n      alignItems: \"center\",\n      spacing: 1,\n      mb: 2,\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body2\",\n        color: \"primary\",\n        sx: {\n          cursor: subject ? 'pointer' : 'default',\n          fontWeight: 500\n        },\n        onClick: subject ? () => onBack('subject') : undefined,\n        children: subject\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 9\n      }, this), module && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          color: \"text.secondary\",\n          children: \"/\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body2\",\n          color: \"primary\",\n          sx: {\n            cursor: 'pointer',\n            fontWeight: 500\n          },\n          onClick: () => onBack('module'),\n          children: module\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true), chapter && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          color: \"text.secondary\",\n          children: \"/\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body2\",\n          color: \"primary\",\n          sx: {\n            cursor: 'pointer',\n            fontWeight: 500\n          },\n          onClick: () => onBack('chapter'),\n          children: chapter\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true), section && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          color: \"text.secondary\",\n          children: \"/\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body2\",\n          color: \"primary\",\n          sx: {\n            cursor: 'pointer',\n            fontWeight: 500\n          },\n          onClick: () => onBack('section'),\n          children: section\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true), topic && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          color: \"text.secondary\",\n          children: \"/\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body2\",\n          color: \"text.primary\",\n          sx: {\n            fontWeight: 700\n          },\n          children: topic\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Stack, {\n      direction: \"row\",\n      alignItems: \"center\",\n      justifyContent: \"space-between\",\n      mb: 2,\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h6\",\n        children: [\"Topic: \", topic]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: onBack,\n        children: \"Back\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 7\n    }, this), perfLoading ? /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 22\n    }, this) : performance && /*#__PURE__*/_jsxDEV(Box, {\n      mb: 2,\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"subtitle2\",\n        children: \"Performance\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body2\",\n        children: [\"Accuracy: \", performance.accuracy !== null ? (performance.accuracy * 100).toFixed(1) + '%' : 'N/A']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body2\",\n        children: [\"Total Reviews: \", performance.totalReviews]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body2\",\n        children: [\"Correct: \", performance.correct]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body2\",\n        children: [\"Last Reviewed: \", performance.lastReviewed ? new Date(performance.lastReviewed).toLocaleString() : 'Never']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Stack, {\n      direction: \"row\",\n      spacing: 2,\n      mb: 2,\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        onClick: handleStart,\n        disabled: cards.length === 0,\n        children: \"Start\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        borderBottom: 1,\n        borderColor: 'divider',\n        mb: 2\n      },\n      children: /*#__PURE__*/_jsxDEV(Stack, {\n        direction: \"row\",\n        spacing: 2,\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          variant: tab === 'cards' ? 'contained' : 'text',\n          onClick: () => {\n            setTab('cards');\n            localStorage.setItem('topicDetailTab', 'cards');\n          },\n          children: \"Cards\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: tab === 'improve' ? 'contained' : 'text',\n          onClick: () => {\n            setTab('improve');\n            localStorage.setItem('topicDetailTab', 'improve');\n          },\n          children: \"Improve\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"subtitle2\",\n      mb: 1,\n      children: [\"Cards in this topic: \", /*#__PURE__*/_jsxDEV(\"b\", {\n        children: cards.length\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 67\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 7\n    }, this), cardsLoading ? /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 23\n    }, this) : /*#__PURE__*/_jsxDEV(Box, {\n      children: cards.length === 0 ? /*#__PURE__*/_jsxDEV(Typography, {\n        children: \"No cards yet.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 33\n      }, this) : /*#__PURE__*/_jsxDEV(DragDropContext, {\n        onDragEnd: handleDragEnd,\n        children: /*#__PURE__*/_jsxDEV(Droppable, {\n          droppableId: \"card-list\",\n          children: provided => /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"card-list\",\n            style: {\n              paddingLeft: 0,\n              listStyle: 'none'\n            },\n            ref: provided.innerRef,\n            ...provided.droppableProps,\n            children: [cards.map((card, idx) => /*#__PURE__*/_jsxDEV(Draggable, {\n              draggableId: card._id,\n              index: idx,\n              children: (provided, snapshot) => /*#__PURE__*/_jsxDEV(\"li\", {\n                className: \"card-list-item\",\n                ref: provided.innerRef,\n                ...provided.draggableProps,\n                ...provided.dragHandleProps,\n                style: {\n                  ...provided.draggableProps.style,\n                  background: snapshot.isDragging ? '#f5f5f5' : 'inherit',\n                  borderRadius: 4\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: highlightKeywords(card.content, card.keywords, tab === 'improve' ? false : false, tab === 'improve' ? card.forgottenBlanks : undefined)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 342,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  size: \"small\",\n                  sx: {\n                    ml: 1\n                  },\n                  onClick: () => handleOpenEditCard(card),\n                  children: \"Edit\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 350,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  size: \"small\",\n                  sx: {\n                    ml: 1\n                  },\n                  onClick: () => handleOpenEditKeywords(card),\n                  children: \"Edit Keywords\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 353,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n                  size: \"small\",\n                  color: \"error\",\n                  sx: {\n                    ml: 1\n                  },\n                  onClick: () => handleDeleteCard(card),\n                  children: /*#__PURE__*/_jsxDEV(DeleteIcon, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 357,\n                    columnNumber: 29\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 356,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 331,\n                columnNumber: 25\n              }, this)\n            }, card._id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 329,\n              columnNumber: 21\n            }, this)), provided.placeholder]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 19\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        display: 'flex',\n        justifyContent: 'flex-end',\n        mt: 3\n      },\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outlined\",\n        onClick: () => setAddOpen(true),\n        children: \"Add Card\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: !!editKeywordsCard,\n      onClose: handleCloseEditKeywords,\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        children: \"Edit Keywords\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 379,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: [/*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            display: 'flex',\n            flexWrap: 'wrap',\n            gap: 1,\n            mb: 1\n          },\n          children: editKeywordsCard && editKeywordsCard.content.split(/\\s+/).map((word, idx) => {\n            const isSelected = Array.isArray(editKeywordsCard.keywordIndices) && editKeywordsCard.keywordIndices.includes(idx);\n            return /*#__PURE__*/_jsxDEV(Button, {\n              variant: isSelected ? 'contained' : 'outlined',\n              color: isSelected ? 'warning' : 'primary',\n              size: \"small\",\n              sx: {\n                minWidth: 0,\n                px: 1,\n                fontWeight: isSelected ? 'bold' : 'normal',\n                bgcolor: isSelected ? '#ffe082' : undefined\n              },\n              onClick: () => handleToggleKeyword(idx),\n              children: word\n            }, idx, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"caption\",\n          color: \"text.secondary\",\n          children: \"Select any words to highlight as keywords.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleCloseEditKeywords,\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleSaveEditKeywords,\n          disabled: editKeywordsLoading,\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: addOpen,\n      onClose: () => setAddOpen(false),\n      maxWidth: \"md\",\n      fullWidth: true,\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        children: \"Add Card\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 3\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: /*#__PURE__*/_jsxDEV(TextField, {\n          autoFocus: true,\n          margin: \"dense\",\n          label: \"Card Content\",\n          fullWidth: true,\n          multiline: true,\n          minRows: 8,\n          value: newCard,\n          onChange: e => setNewCard(e.target.value),\n          inputProps: {\n            style: {\n              fontFamily: 'inherit',\n              whiteSpace: 'pre-line'\n            }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 5\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 3\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => setAddOpen(false),\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 5\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => addCardMutation.mutate(newCard),\n          disabled: !newCard.trim() || addCardMutation.isLoading,\n          children: \"Add\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 5\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 3\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 408,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: editCardModal.open,\n      onClose: handleCloseEditCard,\n      maxWidth: \"md\",\n      fullWidth: true,\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        children: \"Edit Card\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: /*#__PURE__*/_jsxDEV(TextField, {\n          autoFocus: true,\n          margin: \"normal\",\n          label: \"Card Content\",\n          fullWidth: true,\n          multiline: true,\n          minRows: 4,\n          maxRows: 8,\n          value: editCardModal.value,\n          onChange: e => setEditCardModal(modal => ({\n            ...modal,\n            value: e.target.value\n          })),\n          sx: {\n            fontSize: '1.1rem',\n            background: '#fafbfc',\n            borderRadius: 2,\n            width: '100%',\n            maxWidth: {\n              xs: '100%',\n              sm: '600px',\n              md: '900px'\n            },\n            alignSelf: 'center',\n            '& .MuiInputBase-root': {\n              padding: '14px',\n              fontSize: '1.1rem',\n              minHeight: '120px',\n              lineHeight: 1.6\n            },\n            '& textarea': {\n              resize: 'vertical',\n              minHeight: '80px',\n              maxHeight: '220px',\n              width: '100%'\n            }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 432,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 431,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleCloseEditCard,\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleSaveEditCard,\n          disabled: editCardMutation.isLoading || !editCardModal.value.trim(),\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 466,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 464,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: reviewOpen,\n      onClose: handleCloseReview,\n      maxWidth: \"sm\",\n      fullWidth: true,\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        children: \"Review Cards\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 471,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: sessionDone ? /*#__PURE__*/_jsxDEV(Box, {\n          textAlign: \"center\",\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h6\",\n            children: \"Session Complete!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 475,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            children: [\"Score: \", sessionScore, \" / \", cards.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 476,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => setReviewOpen(false),\n            children: \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 477,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 474,\n          columnNumber: 13\n        }, this) : cards[reviewIdx] ? /*#__PURE__*/_jsxDEV(Box, {\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            sx: {\n              mb: 2\n            },\n            children: highlightKeywords(cards[reviewIdx].content, cards[reviewIdx].keywords, true, forgottenBlanks, handleToggleForgotten)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 481,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Stack, {\n            direction: \"row\",\n            spacing: 2,\n            justifyContent: \"center\",\n            mb: 2,\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              variant: \"contained\",\n              color: \"success\",\n              onClick: () => handleReview(true),\n              disabled: reviewMutation.isLoading,\n              children: \"Yes\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 492,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"contained\",\n              color: \"error\",\n              onClick: () => handleReview(false),\n              disabled: reviewMutation.isLoading,\n              children: \"No\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 493,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 491,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"body2\",\n            children: [\"Card \", reviewIdx + 1, \" of \", cards.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 495,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"body2\",\n            children: [\"Score: \", sessionScore]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 496,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 498,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 472,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 470,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 237,\n    columnNumber: 5\n  }, this);\n}\n_s(TopicDetail, \"7YevK+pcn1ulFALvD2cx8lxAb9U=\", false, function () {\n  return [useQueryClient, useQuery, useQuery, useMutation, useMutation, useMutation];\n});\n_c = TopicDetail;\nvar _c;\n$RefreshReg$(_c, \"TopicDetail\");","map":{"version":3,"names":["React","useState","Box","Typography","Button","Dialog","DialogTitle","DialogContent","DialogActions","TextField","CircularProgress","Stack","Paper","IconButton","DeleteIcon","DragDropContext","Droppable","Draggable","useQuery","useMutation","useQueryClient","fetchCardsForTopic","fetchTopicPerformance","addCardToTopic","reviewCard","deleteCard","reorderCards","updateCardKeywords","updateCardContent","Blank","jsxDEV","_jsxDEV","Fragment","_Fragment","TopicDetail","subject","module","chapter","section","topic","onBack","_s","tab","setTab","localStorage","getItem","useEffect","setItem","queryClient","data","performance","isLoading","perfLoading","queryKey","queryFn","enabled","cardsData","cardsLoading","cards","setCards","addOpen","setAddOpen","newCard","setNewCard","addCardMutation","mutationFn","content","onSuccess","invalidateQueries","editCardModal","setEditCardModal","open","card","value","editCardMutation","cardId","handleOpenEditCard","handleCloseEditCard","handleSaveEditCard","trim","mutate","_id","reviewOpen","setReviewOpen","reviewIdx","setReviewIdx","sessionScore","setSessionScore","sessionDone","setSessionDone","forgottenBlanks","setForgottenBlanks","fetchBlanks","_cards$reviewIdx","res","then","api","fetchForgottenBlanks","err","handleToggleForgotten","blankIdx","forgotten","updated","Set","filter","idx","updateForgottenBlanks","reviewMutation","remembered","handleCloseReview","prevCards","_cards$reviewIdx2","map","handleStart","handleReview","s","length","i","handleDragEnd","result","destination","reordered","Array","from","removed","splice","source","index","c","handleDeleteCard","window","confirm","editKeywordsCard","setEditKeywordsCard","editKeywordsLoading","setEditKeywordsLoading","handleOpenEditKeywords","keywordIndices","isArray","keywords","handleToggleKeyword","indices","includes","push","handleCloseEditKeywords","handleSaveEditKeywords","highlightKeywords","text","asBlanks","onToggleForgotten","style","whiteSpace","children","fileName","_jsxFileName","lineNumber","columnNumber","words","split","wordCounter","highlighted","word","test","background","color","sx","p","mt","direction","alignItems","spacing","mb","variant","cursor","fontWeight","onClick","undefined","justifyContent","accuracy","toFixed","totalReviews","correct","lastReviewed","Date","toLocaleString","disabled","borderBottom","borderColor","onDragEnd","droppableId","provided","className","paddingLeft","listStyle","ref","innerRef","droppableProps","draggableId","snapshot","draggableProps","dragHandleProps","isDragging","borderRadius","size","ml","placeholder","display","onClose","flexWrap","gap","isSelected","minWidth","px","bgcolor","maxWidth","fullWidth","autoFocus","margin","label","multiline","minRows","onChange","e","target","inputProps","fontFamily","maxRows","modal","fontSize","width","xs","sm","md","alignSelf","padding","minHeight","lineHeight","resize","maxHeight","textAlign","_c","$RefreshReg$"],"sources":["C:/Users/msi/Desktop/sprint/sprint_code/client/src/components/TopicDetail.js"],"sourcesContent":["import React, { useState } from 'react';\n\nimport { Box, Typography, Button, Dialog, DialogTitle, DialogContent, DialogActions, TextField, CircularProgress, Stack, Paper, IconButton } from '@mui/material';\nimport DeleteIcon from '@mui/icons-material/Delete';\nimport { DragDropContext, Droppable, Draggable } from '@hello-pangea/dnd';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { fetchCardsForTopic, fetchTopicPerformance, addCardToTopic, reviewCard, deleteCard, reorderCards, updateCardKeywords, updateCardContent } from '../api';\nimport Blank from './Blank';\n\nexport default function TopicDetail({ subject, module, chapter, section, topic, onBack }) {\n  // Tabs state (persisted in localStorage)\n  const [tab, setTab] = useState(() => localStorage.getItem('topicDetailTab') || 'cards');\n  // Persist tab selection\n  React.useEffect(() => {\n    localStorage.setItem('topicDetailTab', tab);\n  }, [tab]);\n  // Track card click counts for this session\n\n  // ...\n  // (keep all other hooks and logic)\n\n\n  const queryClient = useQueryClient();\n  // Performance stats\n  const { data: performance, isLoading: perfLoading } = useQuery({\n    queryKey: ['topicPerformance', subject, module, chapter, section, topic],\n    queryFn: () => fetchTopicPerformance(subject, module, chapter, section, topic),\n    enabled: !!topic,\n  });\n  // Cards\n  const { data: cardsData = [], isLoading: cardsLoading } = useQuery({\n    queryKey: ['cards', subject, module, chapter, section, topic],\n    queryFn: () => fetchCardsForTopic(subject, module, chapter, section, topic),\n    enabled: !!topic,\n  });\n  const [cards, setCards] = useState([]);\n  React.useEffect(() => {\n    setCards(cardsData);\n  }, [cardsData]);\n  // Add card modal\n  const [addOpen, setAddOpen] = useState(false);\n  const [newCard, setNewCard] = useState('');\n  const addCardMutation = useMutation({\n    mutationFn: (content) => addCardToTopic(subject, module, chapter, section, topic, content),\n    onSuccess: () => {\n      queryClient.invalidateQueries(['cards', subject, module, chapter, section, topic]);\n      setNewCard('');\n      setAddOpen(false);\n    }\n  });\n\n  // Edit card modal\n  const [editCardModal, setEditCardModal] = useState({ open: false, card: null, value: '' });\n  const editCardMutation = useMutation({\n    mutationFn: ({ cardId, content }) => updateCardContent(cardId, content),\n    onSuccess: () => {\n      queryClient.invalidateQueries(['cards', subject, module, chapter, section, topic]);\n      setEditCardModal({ open: false, card: null, value: '' });\n    }\n  });\n  const handleOpenEditCard = (card) => {\n    setEditCardModal({ open: true, card, value: card.content });\n  };\n  const handleCloseEditCard = () => {\n    setEditCardModal({ open: false, card: null, value: '' });\n  };\n  const handleSaveEditCard = () => {\n    if (editCardModal.card && editCardModal.value.trim()) {\n      editCardMutation.mutate({ cardId: editCardModal.card._id, content: editCardModal.value });\n    }\n  };\n  // Review modal\n  const [reviewOpen, setReviewOpen] = useState(false);\n  const [reviewIdx, setReviewIdx] = useState(0);\n\n  const [sessionScore, setSessionScore] = useState(0);\n  const [sessionDone, setSessionDone] = useState(false);\n  // Track reviewMode for review modal\n\n\n  // --- Forgotten Blanks State ---\n  const [forgottenBlanks, setForgottenBlanks] = useState([]);\n  // Fetch forgotten blanks for the current card in review\n  React.useEffect(() => {\n    async function fetchBlanks() {\n      if (reviewOpen && cards[reviewIdx]?._id) {\n        try {\n          const res = await import('../api').then(api => api.fetchForgottenBlanks(cards[reviewIdx]._id));\n          setForgottenBlanks(res.forgottenBlanks || []);\n        } catch (err) {\n          setForgottenBlanks([]);\n        }\n      }\n    }\n    fetchBlanks();\n  }, [reviewOpen, reviewIdx, cards]);\n  // Handler to toggle forgotten state\n  const handleToggleForgotten = async (blankIdx, forgotten) => {\n    let updated = forgotten\n      ? [...new Set([...forgottenBlanks, blankIdx])] // add\n      : forgottenBlanks.filter(idx => idx !== blankIdx); // remove\n    setForgottenBlanks(updated);\n    // Persist to backend\n    try {\n      await import('../api').then(api => api.updateForgottenBlanks(cards[reviewIdx]._id, updated));\n    } catch {}\n  };\n  const reviewMutation = useMutation({\n    mutationFn: ({ cardId, remembered }) => reviewCard(cardId, remembered),\n    onSuccess: () => {\n      queryClient.invalidateQueries(['cards', subject, module, chapter, section, topic]);\n      queryClient.invalidateQueries(['topicPerformance', subject, module, chapter, section, topic]);\n    }\n  });\n\n  // Start review\n  const handleCloseReview = () => {\n    setReviewOpen(false);\n    // After review session, update forgottenBlanks for the reviewed card\n    setCards(prevCards => {\n      if (!cards[reviewIdx]?._id) return prevCards;\n      return prevCards.map(card =>\n        card._id === cards[reviewIdx]._id\n          ? { ...card, forgottenBlanks: forgottenBlanks }\n          : card\n      );\n    });\n  };\n  const handleStart = () => {\n    setReviewIdx(0);\n    setSessionScore(0);\n    setSessionDone(false);\n    // Reset forgottenBlanks for all cards\n    setCards(prevCards => prevCards.map(card => ({ ...card, forgottenBlanks: [] })));\n    setReviewOpen(true);\n  };\n\n  // Review action\n  const handleReview = (remembered) => {\n    const card = cards[reviewIdx];\n    reviewMutation.mutate({ cardId: card._id, remembered });\n    if (remembered) setSessionScore(s => s + 1);\n    if (reviewIdx + 1 < cards.length) {\n      setReviewIdx(i => i + 1);\n\n    } else {\n      setSessionDone(true);\n    }\n  };\n  // --- Drag and Drop (Reorder) ---\n\n  const handleDragEnd = async (result) => {\n    if (!result.destination) return;\n    const reordered = Array.from(cards);\n    const [removed] = reordered.splice(result.source.index, 1);\n    reordered.splice(result.destination.index, 0, removed);\n    setCards(reordered); // Update local state for instant feedback\n    try {\n      await reorderCards(subject, module, chapter, section, topic, reordered.map(c => c._id));\n      queryClient.invalidateQueries(['cards', subject, module, chapter, section, topic]);\n    } catch (err) {}\n  };\n\n\n  // --- Delete Card ---\n  const handleDeleteCard = (card) => {\n    if (window.confirm('Delete this card?')) {\n      deleteCard(card._id).then(() => {\n        queryClient.invalidateQueries(['cards', subject, module, chapter, section, topic]);\n      });\n    }\n  };\n\n  // --- Keyword Editing State ---\n  const [editKeywordsCard, setEditKeywordsCard] = useState(null);\n  const [editKeywordsLoading, setEditKeywordsLoading] = useState(false);\n  const handleOpenEditKeywords = (card) => {\n    setEditKeywordsCard({ ...card, keywordIndices: Array.isArray(card.keywords) ? card.keywords : [] });\n  };\n  const handleToggleKeyword = (idx) => {\n    let indices = Array.isArray(editKeywordsCard.keywordIndices) ? [...editKeywordsCard.keywordIndices] : [];\n    if (indices.includes(idx)) {\n      indices = indices.filter(i => i !== idx);\n    } else {\n      indices.push(idx);\n    }\n    setEditKeywordsCard({ ...editKeywordsCard, keywordIndices: indices });\n  };\n  const handleCloseEditKeywords = () => {\n    setEditKeywordsCard(null);\n    setEditKeywordsLoading(false);\n  };\n  const handleSaveEditKeywords = async () => {\n    setEditKeywordsLoading(true);\n    try {\n      await updateCardKeywords(editKeywordsCard._id, editKeywordsCard.keywordIndices);\n      queryClient.invalidateQueries(['cards', subject, module, chapter, section, topic]);\n      handleCloseEditKeywords();\n    } catch (err) {\n      setEditKeywordsLoading(false);\n    }\n  };\n\n  function highlightKeywords(text, keywordIndices, asBlanks = false, forgottenBlanks = [], onToggleForgotten = () => {}) {\n    if (!Array.isArray(keywordIndices) || keywordIndices.length === 0)\n      return <span style={{ whiteSpace: 'pre-line' }}>{text}</span>;\n    const words = text.split(/(\\s+)/); // keep spaces as tokens\n    let wordCounter = -1;\n    const highlighted = words.map((word, idx) => {\n      if (/^\\s+$/.test(word)) return word;\n      wordCounter++;\n      if (keywordIndices.includes(wordCounter)) {\n        if (asBlanks) {\n          return (\n            <Blank\n              key={idx}\n              idx={wordCounter}\n              word={word}\n              forgotten={forgottenBlanks.includes(wordCounter)}\n              onToggleForgotten={onToggleForgotten}\n            />\n          );\n        } else {\n          // In cards view, highlight forgotten keywords in red\n        if (forgottenBlanks && forgottenBlanks.includes(wordCounter)) {\n          return <mark key={idx} style={{ background: '#ffcccc', color: '#b71c1c' }}>{word}</mark>;\n        }\n        return <mark key={idx}>{word}</mark>;\n        }\n      }\n      return word;\n    });\n    return <span style={{ whiteSpace: 'pre-line' }}>{highlighted}</span>;\n  }\n\n  return (\n    <Paper sx={{ p: 2, mt: 2 }}>\n      {/* Breadcrumb navigation */}\n      <Stack direction=\"row\" alignItems=\"center\" spacing={1} mb={2}>\n        <Typography\n          variant=\"body2\"\n          color=\"primary\"\n          sx={{ cursor: subject ? 'pointer' : 'default', fontWeight: 500 }}\n          onClick={subject ? () => onBack('subject') : undefined}\n        >\n          {subject}\n        </Typography>\n        {module && <>\n          <Typography color=\"text.secondary\">/</Typography>\n          <Typography\n            variant=\"body2\"\n            color=\"primary\"\n            sx={{ cursor: 'pointer', fontWeight: 500 }}\n            onClick={() => onBack('module')}\n          >\n            {module}\n          </Typography>\n        </>}\n        {chapter && <>\n          <Typography color=\"text.secondary\">/</Typography>\n          <Typography\n            variant=\"body2\"\n            color=\"primary\"\n            sx={{ cursor: 'pointer', fontWeight: 500 }}\n            onClick={() => onBack('chapter')}\n          >\n            {chapter}\n          </Typography>\n        </>}\n        {section && <>\n          <Typography color=\"text.secondary\">/</Typography>\n          <Typography\n            variant=\"body2\"\n            color=\"primary\"\n            sx={{ cursor: 'pointer', fontWeight: 500 }}\n            onClick={() => onBack('section')}\n          >\n            {section}\n          </Typography>\n        </>}\n        {topic && <>\n          <Typography color=\"text.secondary\">/</Typography>\n          <Typography variant=\"body2\" color=\"text.primary\" sx={{ fontWeight: 700 }}>{topic}</Typography>\n        </>}\n      </Stack>\n      <Stack direction=\"row\" alignItems=\"center\" justifyContent=\"space-between\" mb={2}>\n        <Typography variant=\"h6\">Topic: {topic}</Typography>\n        <Button onClick={onBack}>Back</Button>\n      </Stack>\n      {perfLoading ? <CircularProgress /> : performance && (\n        <Box mb={2}>\n          <Typography variant=\"subtitle2\">Performance</Typography>\n          <Typography variant=\"body2\">Accuracy: {performance.accuracy !== null ? (performance.accuracy * 100).toFixed(1) + '%' : 'N/A'}</Typography>\n          <Typography variant=\"body2\">Total Reviews: {performance.totalReviews}</Typography>\n          <Typography variant=\"body2\">Correct: {performance.correct}</Typography>\n          <Typography variant=\"body2\">Last Reviewed: {performance.lastReviewed ? new Date(performance.lastReviewed).toLocaleString() : 'Never'}</Typography>\n        </Box>\n      )}\n      <Stack direction=\"row\" spacing={2} mb={2}>\n        <Button variant=\"contained\" onClick={handleStart} disabled={cards.length === 0}>Start</Button>\n      </Stack>\n      {/* Tabs for Cards/Improve */}\n      <Box sx={{ borderBottom: 1, borderColor: 'divider', mb: 2 }}>\n        <Stack direction=\"row\" spacing={2}>\n          <Button variant={tab === 'cards' ? 'contained' : 'text'} onClick={() => {\n            setTab('cards');\n            localStorage.setItem('topicDetailTab', 'cards');\n          }}>Cards</Button>\n          <Button variant={tab === 'improve' ? 'contained' : 'text'} onClick={() => {\n            setTab('improve');\n            localStorage.setItem('topicDetailTab', 'improve');\n          }}>Improve</Button>\n        </Stack>\n      </Box>\n      <Typography variant=\"subtitle2\" mb={1}>Cards in this topic: <b>{cards.length}</b></Typography>\n      {cardsLoading ? <CircularProgress /> : (\n        <Box>\n          {cards.length === 0 ? <Typography>No cards yet.</Typography> : (\n            <DragDropContext onDragEnd={handleDragEnd}>\n              <Droppable droppableId=\"card-list\">\n                {(provided) => (\n                  <ul\n                  className=\"card-list\"\n                  style={{ paddingLeft: 0, listStyle: 'none' }}\n                  ref={provided.innerRef}\n                  {...provided.droppableProps}\n                >\n                  {cards.map((card, idx) => (\n                    <Draggable key={card._id} draggableId={card._id} index={idx}>\n                      {(provided, snapshot) => (\n                        <li\n                          className=\"card-list-item\"\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                          {...provided.dragHandleProps}\n                          style={{\n                            ...provided.draggableProps.style,\n                            background: snapshot.isDragging ? '#f5f5f5' : 'inherit',\n                            borderRadius: 4,\n                          }}\n                        >\n                          <span>\n                            {highlightKeywords(\n  card.content,\n  card.keywords,\n  tab === 'improve' ? false : false,\n  tab === 'improve' ? card.forgottenBlanks : undefined\n)}\n                          </span>\n                          <Button size=\"small\" sx={{ ml: 1 }} onClick={() => handleOpenEditCard(card)}>\n                            Edit\n                          </Button>\n                          <Button size=\"small\" sx={{ ml: 1 }} onClick={() => handleOpenEditKeywords(card)}>\n                            Edit Keywords\n                          </Button>\n                          <IconButton size=\"small\" color=\"error\" sx={{ ml: 1 }} onClick={() => handleDeleteCard(card)}>\n                            <DeleteIcon />\n                          </IconButton>\n                        </li>\n                      )}\n                    </Draggable>\n                  ))}\n                  {provided.placeholder}\n                </ul>\n                )}\n              </Droppable>\n            </DragDropContext>\n          )}\n        </Box>\n      )}\n\n      {/* Add Card Button at the bottom */}\n      <Box sx={{ display: 'flex', justifyContent: 'flex-end', mt: 3 }}>\n        <Button variant=\"outlined\" onClick={() => setAddOpen(true)}>Add Card</Button>\n      </Box>\n\n      {/* Edit Keywords Dialog */}\n      <Dialog open={!!editKeywordsCard} onClose={handleCloseEditKeywords}>\n        <DialogTitle>Edit Keywords</DialogTitle>\n        <DialogContent>\n          <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1, mb: 1 }}>\n            {editKeywordsCard && editKeywordsCard.content.split(/\\s+/).map((word, idx) => {\n              const isSelected = Array.isArray(editKeywordsCard.keywordIndices) && editKeywordsCard.keywordIndices.includes(idx);\n              return (\n                <Button\n                  key={idx}\n                  variant={isSelected ? 'contained' : 'outlined'}\n                  color={isSelected ? 'warning' : 'primary'}\n                  size=\"small\"\n                  sx={{ minWidth: 0, px: 1, fontWeight: isSelected ? 'bold' : 'normal', bgcolor: isSelected ? '#ffe082' : undefined }}\n                  onClick={() => handleToggleKeyword(idx)}\n                >\n                  {word}\n                </Button>\n              );\n            })}\n          </Box>\n          <Typography variant=\"caption\" color=\"text.secondary\">Select any words to highlight as keywords.</Typography>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleCloseEditKeywords}>Cancel</Button>\n          <Button onClick={handleSaveEditKeywords} disabled={editKeywordsLoading}>\n            Save\n          </Button>\n        </DialogActions>\n      </Dialog>\n      {/* Add Card Modal */}\n      <Dialog open={addOpen} onClose={() => setAddOpen(false)} maxWidth=\"md\" fullWidth>\n  <DialogTitle>Add Card</DialogTitle>\n  <DialogContent>\n    <TextField\n      autoFocus\n      margin=\"dense\"\n      label=\"Card Content\"\n      fullWidth\n      multiline\n      minRows={8}\n      value={newCard}\n      onChange={e => setNewCard(e.target.value)}\n      inputProps={{ style: { fontFamily: 'inherit', whiteSpace: 'pre-line' } }}\n    />\n  </DialogContent>\n  <DialogActions>\n    <Button onClick={() => setAddOpen(false)}>Cancel</Button>\n    <Button onClick={() => addCardMutation.mutate(newCard)} disabled={!newCard.trim() || addCardMutation.isLoading}>Add</Button>\n  </DialogActions>\n</Dialog>\n      {/* Edit Card Modal */}\n      <Dialog open={editCardModal.open} onClose={handleCloseEditCard} maxWidth=\"md\" fullWidth>\n        <DialogTitle>Edit Card</DialogTitle>\n        <DialogContent>\n          <TextField\n            autoFocus\n            margin=\"normal\"\n            label=\"Card Content\"\n            fullWidth\n            multiline\n            minRows={4}\n            maxRows={8}\n            value={editCardModal.value}\n            onChange={e => setEditCardModal(modal => ({ ...modal, value: e.target.value }))}\n            sx={{\n              fontSize: '1.1rem',\n              background: '#fafbfc',\n              borderRadius: 2,\n              width: '100%',\n              maxWidth: { xs: '100%', sm: '600px', md: '900px' },\n              alignSelf: 'center',\n              '& .MuiInputBase-root': {\n                padding: '14px',\n                fontSize: '1.1rem',\n                minHeight: '120px',\n                lineHeight: 1.6\n              },\n              '& textarea': {\n                resize: 'vertical',\n                minHeight: '80px',\n                maxHeight: '220px',\n                width: '100%'\n              }\n            }}\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleCloseEditCard}>Cancel</Button>\n          <Button onClick={handleSaveEditCard} disabled={editCardMutation.isLoading || !editCardModal.value.trim()}>Save</Button>\n        </DialogActions>\n      </Dialog>\n      {/* Review Modal */}\n      <Dialog open={reviewOpen} onClose={handleCloseReview} maxWidth=\"sm\" fullWidth>\n        <DialogTitle>Review Cards</DialogTitle>\n        <DialogContent>\n          {sessionDone ? (\n            <Box textAlign=\"center\">\n              <Typography variant=\"h6\">Session Complete!</Typography>\n              <Typography>Score: {sessionScore} / {cards.length}</Typography>\n              <Button onClick={() => setReviewOpen(false)}>Close</Button>\n            </Box>\n          ) : cards[reviewIdx] ? (\n            <Box>\n              <Typography sx={{ mb: 2 }}>\n                {highlightKeywords(\n  cards[reviewIdx].content,\n  cards[reviewIdx].keywords,\n  true,\n  forgottenBlanks,\n  handleToggleForgotten\n)}\n              </Typography>\n\n              <Stack direction=\"row\" spacing={2} justifyContent=\"center\" mb={2}>\n                <Button variant=\"contained\" color=\"success\" onClick={() => handleReview(true)} disabled={reviewMutation.isLoading}>Yes</Button>\n                <Button variant=\"contained\" color=\"error\" onClick={() => handleReview(false)} disabled={reviewMutation.isLoading}>No</Button>\n              </Stack>\n              <Typography variant=\"body2\">Card {reviewIdx + 1} of {cards.length}</Typography>\n              <Typography variant=\"body2\">Score: {sessionScore}</Typography>\n            </Box>\n          ) : <CircularProgress />}\n        </DialogContent>\n      </Dialog>\n    </Paper>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}